# 2023C题

这是一个非常经典且极具现实意义的**运营优化问题**，融合了**数据分析、需求预测、定价策略和库存管理**。这是一个典型的数学建模竞赛题目，旨在考察综合运用多种模型解决复杂商业问题的能力。

我们来逐一分析这四个问题，并为每个问题选择最恰当的算法或模型，重点阐述其思想。

---

### 问题1：分析销售量的分布规律及相互关系

**核心任务**：探索性数据分析 (EDA)，理解数据。
1.  **分布规律**：单个品类/单品的销量是如何分布的？是正态分布？泊松分布？还是有明显的季节性、周期性？
2.  **相互关系**：不同品类/单品之间是否存在“替代”或“互补”关系？比如，买了西红柿的人是不是也倾向于买鸡蛋？白菜销量高的时候，生菜销量会不会低？

**恰当的算法与思想：**

1.  **分布规律分析**：
    *   **思想**：描述性统计 + 概率分布拟合。
    *   **算法**：
        *   **描述性统计**：计算每个品类/单品的均值、中位数、方差、峰度、偏度等，快速了解其集中趋势和离散程度。
        *   **可视化**：绘制**直方图**和**核密度估计图 (KDE)**，直观地观察销量的分布形状。
        *   **时间序列分解**：将每个品类的日销量数据进行**季节性分解**，查看是否存在明显的**趋势项、季节项（周/月/年周期）和残差项**。这能告诉我们销量是否存在固定的时间规律。
        *   **概率分布拟合检验**：使用**卡方检验**或**KS检验**，检验销量数据是否服从某种理论分布（如正态分布、泊松分布等），这对于后续的库存模型（如报童模型）可能有帮助。

2.  **相互关系分析**：
    *   **思想**：关联规则挖掘 / 相关性分析。
    *   **算法**：
        *   **相关系数矩阵**：计算不同品类/单品日销量之间的**皮尔逊 (Pearson) 相关系数**。相关系数高且为正，可能存在互补关系；高且为负，可能存在替代关系。并用**热力图**进行可视化。
        *   **关联规则挖掘 (Apriori 算法)**：这是分析“购物篮”的经典方法。我们可以将每一笔订单看作一个“购物篮”，然后使用Apriori算法挖掘出**支持度 (Support)**、**置信度 (Confidence)**和**提升度 (Lift)** 较高的规则。例如，挖掘出 `{西红柿} -> {鸡蛋}` 这样的强关联规则。提升度大于1表示正相关（互补），小于1表示负相关（替代）。
        *   **协同过滤 (Collaborative Filtering)**：虽然常用于推荐系统，但其思想可以借鉴。通过分析用户-商品购买矩阵，可以发现哪些商品经常被同一类顾客购买。

---

### 问题2：品类级别的补货与定价决策（收益最大化）

**核心任务**：需求预测 + 定价优化。这是一个典型的**运筹学**问题。

**恰当的算法与思想：**

1.  **需求预测**：预测未来一周（7月1-7日）各品类的**日需求量**。
    *   **思想**：时间序列预测。
    *   **算法**：
        *   **SARIMA模型**：考虑到蔬菜销量可能存在明显的周周期性（周末销量高等）和年度季节性，SARIMA模型是经典且强大的选择。它可以同时处理趋势和多重季节性。
        *   **Prophet模型**：Facebook开源的Prophet模型非常擅长处理具有多重季节性（周、年）和节假日效应的时间序列，且使用简单、结果稳健，非常适合此类商业预测。
        *   **基于机器学习的模型 (如XGBoost, LightGBM)**：通过构建大量的**时间特征**（如星期几、是否节假日、月份、滞后销量等）和**价格特征**（历史定价），可以将预测问题转化为一个监督学习的回归问题。这种方法可以捕捉更复杂的非线性关系，通常精度更高。

2.  **定价与补货联合优化**：
    *   **思想**：建立以**总收益最大化**为目标的数学规划模型。
    *   **模型**：
        *   **收益函数**：总收益 = (各品类销售收入) - (各品类补货成本) - (各品类缺货损失) - (各品类损耗/打折损失)。
        *   **决策变量**：未来7天，每个品类的**日补货量 `Q_i`** 和**成本加成定价的加成率 `p_i`**。
        *   **关键关系**：需要建立**销量与定价的关系模型**，即**价格弹性模型**。通常假设 `销量 = f(价格)`，这个函数 `f` 可以通过历史数据进行回归拟合（例如，线性回归 `销量 = a*价格 + b`）。
        *   **约束条件**：补货量非负等。
        *   **求解**：这是一个**非线性规划 (Non-Linear Programming, NLP)** 问题，因为收益函数中销量是价格的函数，导致目标函数中出现 `价格 * 销量(价格)` 这样的非线性项。可以使用成熟的优化求解器（如 LINGO, Gurobi, 或Python中的 `scipy.optimize`）来求解。
        *   **简化思想：报童模型 (Newsvendor Model)**：如果定价策略是固定的，问题就简化为经典的库存管理问题。对于保质期只有一天的蔬菜，报童模型是完美的理论框架。它通过平衡“缺货损失成本”和“库存积压成本（损耗）”，来找到一个最优的补货量，使得期望收益最大。

---

### 问题3：单品级别的补货与定价决策（有约束的最优化）

**核心任务**：在问题2的基础上，增加更复杂的组合约束。

**恰当的算法与思想：**

*   **思想**：这是一个典型的**整数规划 (Integer Programming)** 或 **混合整数规划 (Mixed-Integer Programming, MIP)** 问题，也被称为**背包问题 (Knapsack Problem)** 的变种。
*   **模型**：
    *   **目标函数**：与问题2类似，最大化7月1日的总收益。
    *   **决策变量**：
        *   对**每个可售单品 `j`**，决定其**是否补货**（一个0-1二进制变量 `y_j`）。
        *   如果补货，决定其**具体补货量 `q_j`** (一个连续或整数变量)。
        *   决定其**定价策略 `p_j`** (一个连续变量)。
    *   **约束条件**：
        1.  `Σ y_j` 在 `[27, 33]` 之间 (可售单品总数约束，这是**整数约束**)。
        2.  如果 `y_j = 1`，那么 `q_j >= 2.5` (最小陈列量约束)。
        3.  `Σ q_j` （某个品类的总补货量）应“尽量满足”市场需求。这里的“尽量满足”是一个模糊的目标，可以转化为比如“最小化缺货率”或者将其作为软约束放入目标函数中。
    *   **求解**：这是一个复杂的**混合整数非线性规划 (MINLP)** 问题，因为既有整数决策变量，又有非线性的目标函数。这类问题通常非常难解。
        *   **简化策略**：可以先固定定价（比如根据历史平均加成率），将问题转化为一个**混合整数线性规划 (MILP)**，这样就可以用 Gurobi, CPLEX 等高效求解器解决。
        *   **启发式算法**：如果问题规模太大或过于复杂，可以使用**遗传算法 (Genetic Algorithm)** 或**模拟退火 (Simulated Annealing)** 等元启发式算法来寻找近似最优解。算法的“个体”就是一个完整的补货与定价方案，“适应度函数”就是该方案下的总收益。

---

### 问题4：数据采集建议

**核心任务**：识别当前模型的局限性，并提出改进方向。

**思想**：从**需求、供给、竞争、环境**四个维度思考。
*   **需求侧**：
    *   **客户画像数据**：会员信息（年龄、性别等）、消费记录。可以做更精准的客户分群，实现差异化定价和推荐。
    *   **促销活动数据**：历史上的打折、满减活动对销量的影响。可以量化促销弹性。
    *   **线上评价/舆情数据**：了解客户对品相、价格的反馈。
*   **供给侧**：
    *   **供应链信息**：更精确的到货时间、运输途中的损耗率。可以优化补货提前期和安全库存。
    *   **产地/天气数据**：主要蔬菜产地的天气情况会影响未来的供应量和批发价，可以作为预测批发价的外部特征。
*   **竞争侧**：
    *   **竞争对手定价数据**：周边超市、线上平台的同类商品价格。可以制定更具竞争力的动态定价策略。
*   **环境因素**：
    *   **天气预报数据**：节假日、气温、是否下雨等都会显著影响蔬菜销量。例如，火锅类蔬菜在降温时销量会大增。这些都是需求预测模型中极其重要的外部变量。

**总结**：这道题是一个层层递进的综合优化问题。从最基础的**数据探索**，到**时间序列预测**，再到**无约束的非线性规划**，最后升级为**有复杂约束的混合整数规划**。解决好这个问题的关键在于，能够根据问题的具体情境，灵活地选择并整合这些来自不同领域的数学和算法工具。